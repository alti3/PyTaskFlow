{% extends "_layout.html.j2" %}

{% block content %}
    <div class="mb-6 space-y-1">
        <h1 class="text-2xl font-semibold tracking-tight">Recurring Jobs</h1>
        <p class="text-sm text-slate-500">Scheduled workloads and their most recent execution time.</p>
    </div>
    <div class="mb-6 flex flex-wrap items-center gap-2 text-xs">
        <span class="text-xs font-semibold uppercase tracking-wider text-slate-500">State colors</span>
        <span class="h-3 w-px bg-slate-200"></span>
        <span class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-600">
            <span class="h-2 w-2 rounded-full bg-sky-500"></span>Enqueued
        </span>
        <span class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-600">
            <span class="h-2 w-2 rounded-full bg-amber-500 processing-pulse"></span>Processing
        </span>
        <span class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-600">
            <span class="h-2 w-2 rounded-full bg-emerald-500"></span>Succeeded
        </span>
        <span class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-600">
            <span class="h-2 w-2 rounded-full bg-rose-500"></span>Failed
        </span>
        <span class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-600">
            <span class="h-2 w-2 rounded-full bg-indigo-500"></span>Awaiting
        </span>
        <span class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-600">
            <span class="h-2 w-2 rounded-full bg-orange-500"></span>Cancelled
        </span>
        <span class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-2.5 py-1 text-slate-600">
            <span class="h-2 w-2 rounded-full bg-slate-400"></span>Deleted
        </span>
    </div>

    <div class="overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm">
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-slate-200 text-sm">
                <thead class="bg-slate-50 text-left text-xs font-semibold uppercase tracking-wider text-slate-500">
                    <tr>
                        <th scope="col" class="px-4 py-3">ID</th>
                        <th scope="col" class="px-4 py-3">Task</th>
                        <th scope="col" class="px-4 py-3">Cron</th>
                        <th scope="col" class="px-4 py-3">Last Execution</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-slate-100">
                    {% if jobs %}
                        {% for job in jobs %}
                            <tr class="transition hover:bg-slate-50">
                                <td class="border-l-4 border-indigo-200 px-4 py-3 text-xs font-medium text-slate-500">
                                    <span class="inline-flex items-center gap-2">
                                        <span class="h-2 w-2 rounded-full bg-indigo-500"></span>
                                        {{ job.id }}
                                    </span>
                                </td>
                                <td class="px-4 py-3 text-sm text-slate-700">
                                    <code class="rounded-md bg-slate-100 px-2 py-1 text-xs text-slate-700">{{ job.job.target_module }}.{{ job.job.target_function }}</code>
                                </td>
                                <td class="px-4 py-3 text-sm text-slate-600">{{ job.cron }}</td>
                                <td class="px-4 py-3 text-sm text-slate-600">{{ job.last_execution or "â€”" }}</td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="4" class="px-4 py-8 text-center text-sm text-slate-500">No recurring jobs found.</td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    {% if jobs %}
        <div class="mt-5">
            {% include "_pagination.html.j2" %}
        </div>
    {% endif %}
{% endblock %}
